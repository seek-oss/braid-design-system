language: node_js
cache: yarn
notifications:
  email: false
before_script:
  - npm prune
after_success:
  - if [ ${TRAVIS_SECURE_ENV_VARS} = "true" ]; then
      if [ "$TRAVIS_BRANCH" == "master" ]; then
        npm run travis-deploy-once "npm run semantic-release";

        git config --global user.name "Travis-CI";
        git config --global user.email "travis@example.com";
        npm run travis-deploy-once "npm run deploy";
      fi
    fi
branches:
  except:
    - /^v\d+\.\d+\.\d+$/
